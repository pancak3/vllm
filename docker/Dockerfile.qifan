FROM harbor.qifand.com/llm-infer/vllm-openai-base:latest AS builder

COPY vllm.tar /tmp/vllm.tar
RUN mkdir -p /tmp/project && cd /tmp/project && tar -xf /tmp/vllm.tar && \
	cp -r /tmp/project/vllm/entrypoints/* /usr/local/lib/python3.12/dist-packages/vllm/entrypoints/


FROM harbor.qifand.com/llm-infer/vllm-openai-base:latest

COPY --from=builder /usr/local/lib/python3.12/dist-packages/ /usr/local/lib/python3.12/dist-packages/

COPY ./docker/run.sh /usr/local/bin/run.sh
ENTRYPOINT ["/usr/local/bin/run.sh"]